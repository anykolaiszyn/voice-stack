# Configuration file for Synapse.
#
# This is a YAML file: see [1] for a quick introduction. Note in particular
# that *indentation is important*: all the elements of a list or dictionary
# should have the same indentation.
#
# [1] https://docs.ansible.com/ansible/latest/reference_appendices/YAMLSyntax.html

## Server ##

server_name: "matrix.byte-box.org"
public_baseurl: "https://matrix.byte-box.org/"
pid_file: /data/homeserver.pid
web_client_location: "https://chat.byte-box.org/"

## Database ##

database:
  name: psycopg2
  args:
    user: synapse
    password: synapse_password
    database: synapse
    host: postgres
    cp_min: 5
    cp_max: 10

## Logging ##

log_config: "/data/log.config"

## Media Store ##

media_store_path: "/media_store"
max_upload_size: 50M
max_image_pixels: 32M

## Captcha ##
# See docs/CAPTCHA_SETUP.md for full details of configuring this.

# This Home Server's ReCAPTCHA public key.
recaptcha_public_key: ""

# This Home Server's ReCAPTCHA private key.
recaptcha_private_key: ""

# Enables ReCaptcha checks when registering, prevents robots from registering.
enable_registration_captcha: false

## TURN ##

turn_uris:
  - "turn:coturn:3478?transport=udp"
  - "turn:coturn:3478?transport=tcp"
  - "turns:coturn:5349?transport=udp"
  - "turns:coturn:5349?transport=tcp"

turn_shared_secret: "your_turn_secret_key_here"
turn_user_lifetime: 1h
turn_allow_guests: true

## Registration ##

enable_registration: true
enable_registration_without_verification: true
registration_shared_secret: "your_registration_secret_here"

## API Configuration ##

listeners:
  - port: 8008
    tls: false
    type: http
    x_forwarded: true
    bind_addresses: ['::1', '127.0.0.1', '0.0.0.0']

    resources:
      - names: [client, federation]
        compress: false

  - port: 8448
    type: http
    tls: false
    bind_addresses: ['::1', '127.0.0.1', '0.0.0.0']
    resources:
      - names: [federation]

## Homeserver signing key ##

signing_key_path: "/data/signing.key"

## Single sign-on integration ##

# The following settings can be used to make Synapse use a single sign-on
# provider for authentication, instead of its internal password database.

# Enable SAML2 for registration and login. Uses pysaml2.
saml2_config:
  sp_config:
    # Point this to the IdP's metadata. You must provide either a local
    # file via the "local" attribute or (preferably) a URL via the
    # "remote" attribute.
    metadata:
      #local: ["saml2/idp.xml"]
      remote:
        - url: https://our_idp/metadata.xml

## Push ##

push:
  include_content: true

## Trusted key servers ##

trusted_key_servers:
  - server_name: "matrix.org"

## Rooms ##

autocreate_auto_join_rooms: true

## User directory ##

user_directory:
  enabled: true
  search_all_users: true

## Redis ##

redis:
  enabled: true
  host: redis
  port: 6379

## Metrics ##

enable_metrics: false

## Reporting ##

report_stats: false

## Application Services ##

app_service_config_files: []

## Macaroon keys ##

macaroon_secret_key: "your_macaroon_secret_here"

## Form secret ##

form_secret: "your_form_secret_here"
